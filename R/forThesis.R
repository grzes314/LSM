######################################################################
### European up-and-out call with E=100, T=1, vol=0.3, r=0 ###
spot <- c(50.0, 55.0, 60.0, 65.0, 70.0, 75.0, 80.0, 85.0, 90.0, 95.0, 100.0, 105.0, 110.0, 115.0, 120.0, 125.0, 130.0, 135.0, 140.0, 145.0)
barrier <- c(100.0, 102.0, 104.0, 106.0, 108.0, 110.0, 112.0, 114.0, 116.0, 118.0, 120.0, 122.0, 124.0, 126.0, 128.0, 130.0, 132.0, 134.0, 136.0, 138.0)
prices <- matrix( c(
  0.0, 1.1470275163726062E-4, 7.770669639721936E-4, 0.0022387237346356004, 0.0045366312499360295, 0.007582980674538414, 0.011227666524283364, 0.015299423250329014, 0.01963113379421344, 0.02407391000728587, 0.028503573667524262, 0.03282226785683118, 0.03695716570753327, 0.040857634876541815, 0.04449175342196665, 0.04784273549881979, 0.05090558898713127, 0.053684168186210024, 0.05618868255240261, 0.05843366052449395, 
  0.0, 2.1102624635226802E-4, 0.001463604601132415, 0.004310967813930311, 0.008920758290985265, 0.015208615727143604, 0.022941273570824428, 0.031812090120120096, 0.04149338744002129, 0.05167035226309369, 0.062060990082326795, 0.07242602728205316, 0.08257193637460736, 0.09234954563268882, 0.10165005685042328, 0.11039976368087312, 0.11855434301591239, 0.12609327427723138, 0.1330147109113078, 0.13933096770767905, 
  0.0, 3.26753117744466E-4, 0.0023360632077776278, 0.00704100034186006, 0.014878348193613, 0.025865712920825956, 0.03973826248783885, 0.05606047795244962, 0.07431247400377394, 0.09395298990270962, 0.1144624600411892, 0.1353700191852254, 0.15626819434858064, 0.17681862367164047, 0.19675159340188797, 0.2158616087941514, 0.23400067948504377, 0.2510705378839475, 0.267014631797331, 0.28181043801665195, 
  0.0, 4.419478201934113E-4, 0.003258699769966039, 0.010052167575283044, 0.021691062218583523, 0.03845172120032547, 0.060163482339759655, 0.0863440532832982, 0.11631660412098821, 0.14930503530046568, 0.1845071419041191, 0.22114743745151388, 0.2585124916866257, 0.29597204614530126, 0.33298913098203275, 0.3691221006079477, 0.40402106944223704, 0.4374207547899207, 0.4691312791836122, 0.4990280812297012, 
  0.0, 5.366611948684347E-4, 0.0040603773285379785, 0.012813828592752707, 0.028240036384483025, 0.051058389892666645, 0.08138024802815069, 0.11884085677822487, 0.16273084404722393, 0.2121163989992758, 0.2659420317326955, 0.32311343572281714, 0.38256050818690834, 0.4432821852023787, 0.5043756181873986, 0.5650525535228654, 0.6246457514195098, 0.6826080342733754, 0.7385061947269858, 0.7920115939890477, 
  0.0, 5.94188695321976E-4, 0.004581469296481622, 0.014789918659808277, 0.03331200434792936, 0.06147367595613917, 0.09987894963195121, 0.1485028058891249, 0.20680960352374012, 0.27387937316605093, 0.3485294481155021, 0.42942340495809894, 0.515162970993579, 0.6043613461062751, 0.6956983401573087, 0.7879589659560029, 0.8800578009542122, 0.9710516857989475, 1.0601432962596835, 1.1466779147543047, 
  0.0, 5.987970990050523E-4, 0.004704053305315592, 0.015564402837740077, 0.035897970819026126, 0.06773187854378904, 0.11234372495264999, 0.17028086218858673, 0.24143348159601707, 0.3251400968020679, 0.4203078229777546, 0.525534063330789, 0.6392202537984151, 0.7596718447059487, 0.8851815543823367, 1.0140950836835376, 1.1448599837763336, 1.2760593190384242, 1.4064322765132964, 1.5348840558076429, 
  0.0, 5.352515656507073E-4, 0.004365468753422919, 0.014912007548681494, 0.03538984337830864, 0.06852154736960969, 0.11636202401765239, 0.1802199386764669, 0.2606566526765972, 0.357542049822845, 0.470147716054659, 0.5972605286366939, 0.7373030326444425, 0.8884504526328367, 1.0487374223492498, 1.2161502939599824, 1.3887031145686635, 1.5644970242742975, 1.7417639850791193, 1.9188964720344224, 
  0.0, 4.019274111691229E-4, 0.003573839231509446, 0.012827413058956072, 0.031661626061826764, 0.06338261055147676, 0.1108208628061691, 0.17614757289067295, 0.2607813459078434, 0.3653705357832866, 0.4898338192640699, 0.633441546250161, 0.7949219593897503, 0.9725788695387205, 1.164410252330505, 1.3682200998377603, 1.5817184651978948, 1.802606837036663, 2.028647721540974, 2.257718600627207, 
  0.0, 2.475905162483E-4, 0.0024495443812593, 0.009551399085074685, 0.025081775872422774, 0.05273253894485341, 0.09600007546787781, 0.1579088706493441, 0.24082338111765011, 0.34634371751738513, 0.47527410393329994, 0.6276497110964847, 0.8028064887848689, 0.9994793313312709, 1.2159156739004473, 1.4499939285317893, 1.6993386436557465, 1.9614266412897194, 2.233680485922985, 2.513547382963317, 
  0.0, 8.09485157928641E-5, 0.0011520912178993037, 0.005475345035978185, 0.016365797953017625, 0.03765765586357661, 0.07331738636626595, 0.12710533183019068, 0.20230695328854154, 0.3015426259161593, 0.42665478869152196, 0.5786645295029089, 0.757785834571596, 0.9634841234714635, 1.1945657287760394, 1.44928612299773, 1.725466489451609, 2.020610317467227, 2.3320138104132084, 2.656865848227575, 
  0.0, 0.0, 0.0, 9.326773991909232E-4, 0.006304698705753065, 0.019543804795644215, 0.044843469899706, 0.08649707346326063, 0.14858009906552505, 0.23468785890107835, 0.34774462831773256, 0.4898840197635117, 0.6623952199641199, 0.8657256018024455, 1.0995281762121625, 1.3627418726447225, 1.6536932686093984, 1.9702097274522075, 2.309735618915269, 2.669445135034195, 
  0.0, 0.0, 0.0, 0.0, 0.0, 3.108624468950438E-14, 0.013078383307695007, 0.03960911834576342, 0.08424711630332538, 0.15141170111349878, 0.2450402052990137, 0.36839509774568313, 0.5239381268062484, 0.7132674511569679, 0.9371094612213486, 1.1953554218211675, 1.4871322076628068, 1.8108966234714927, 2.1645437493990833, 2.545521132800797, 
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01425336683623446, 0.05811281191893847, 0.12639814657319248, 0.22340736522960203, 0.3527590958591791, 0.5172690767881196, 0.7188751480093121, 0.9586190462617399, 1.2366726103966403, 1.552398818491124, 1.9044380308265971, 2.290810435352224, 
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1102230246251565E-15, 0.0649424306251839, 0.16067390818201277, 0.2911882220410025, 0.45966575955908784, 0.668402981602843, 0.9187841970978372, 1.2112955324756012, 1.545576311903563, 1.9204968041209582, 
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.04912875594394461, 0.1756599625022337, 0.34276933341558946, 0.5531265855090677, 0.8084706635392971, 1.109626667563342, 1.4565423860396383, 
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.609823385706477E-14, 0.16027884367588063, 0.366578992169702, 0.6210159379196067, 0.9247668095404951, 
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.10454542560769298, 0.35219103733129353, 
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
), nrow=20, byrow=TRUE )
######################################################################

library("rgl")
makeChart3D <- function(xs, ys, zs, xlab, ylab, zlab)
{
  val_lim <- range(zs)
  vlen <- ceiling(val_lim[2] - val_lim[1] + 1)
  #vlen = 10
  colorlut <- terrain.colors(vlen)
  col <- colorlut[ zs - val_lim[1]+1 ]
  open3d()
  persp3d(xs, ys, zs, color=col, axes=FALSE, back="lines", xlab = xlab, ylab = ylab, zlab = "")
  axes3d( edges=c("x--", "y--") )
  #image.plot( legend.only=TRUE, zlim= c(min(zs), max(zs)), nlevel=vlen,  col=colorlut)
}
